<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>Maracuya - Virtual Jukebox, lan mp3 player</title>

<script src="../cordova.js"></script>
<script src="external/requirejs-2.1.2.js"></script>

<link rel="stylesheet" href="skins/jqm14/jquery.mobile-1.4.0.min.css" />
<link rel="stylesheet" href="skins/maracuya-mobile/style.css" />

<!-- @ifdef WEINRE_URL -->
<script src="<!-- @echo WEINRE_URL -->/target/target-script-min.js#anonymous"></script>
<!-- @endif -->

<script>
require.config({
  paths: {
      <!-- @exclude -->
      "io" : "../external/socket.io.min",
      "underscore": "../external/lodash-1.0.0-rc.3",
      "domReady": "../external/plugins/domReady-2.0.1",
      "jquery": "../external/jquery-1.8.3.min",
      "jqm": "../external/jquery.mobile-1.4.0",
      "playlist": "../../mobile/scripts/playlist",
      "scanner": "../../mobile/scripts/scanner",
      "eventHandler": "../../mobile/scripts/eventHandler",
      <!-- @endexclude -->
      "mobile": "../../mobile/scripts/mobile"
  },
  baseUrl: "../public/scripts",
  <!-- @exclude -->
  shim: {
    jqm: {
      deps: ['jquery'],
      exports: 'jQuery.mobile'
    }
  }
  <!-- @endexclude -->
});

require(['mobile'], function(mobile) {

    function init() {
        var mBus = mobile.init(),
            connectUrl;

        <!-- @if NODE_ENV='android' -->
        connectUrl = 'http://10.0.2.2:8280';
        <!-- @endif -->

        <!-- @if NODE_ENV='development' -->
        connectUrl = 'http://localhost:8280';
        <!-- @endif -->

        if (connectUrl) {
            _.defer(function() {
                mBus.notify('connect', connectUrl);
            });
        }
    }

    if (window.cordova) {
        document.addEventListener('deviceready', init);
    } else {
        $(init);
    }
});

</script>
</head>

<body>
<div data-role="page" id="main">
    <input type="text" id="connectUrl" value="http://localhost:8280" data-mini="true" />
    <div data-role="controlgroup" data-type="horizontal">
        <input type="button" id="connect" value="connect" data-mini="true" />
        <input type="button" id="scan" value="scan" data-mini="true" />
    </div>
</div>
<div data-role="page" id="player">
    <ui data-role="listview" id="playlist" data-filter="true">
    </ui>
    <div id="footer" data-role="footer" data-position="fixed">
        <div data-role="controlgroup" data-type="horizontal">
            <input type="button" data-action="prev" data-icon="maracuya-prev" data-iconpos="notext" data-inline="true" value="Previous">
            <input type="button" data-action="stop" data-icon="maracuya-stop" data-iconpos="notext" data-inline="true" value="Stop">
            <input type="button" data-action="play" data-icon="maracuya-play" data-iconpos="notext" data-inline="true" value="Play">
            <input type="button" data-action="next" data-icon="maracuya-next" data-iconpos="notext" data-inline="true" value="Next">
        </div>
    </div>
</div>
<div data-role="page" id="connectFailed">
  <div data-role="header">
    <h2>Connect failed</h2>
  </div>
  <div role="main" class="ui-content">
    <p>I was unable to connect to given address.</p>
  </div>
</div>
</body>
</html>
